name: Sync tc01d to develop
on:
  push:
    branches:
      - tc01d

jobs:
  createPullRequest:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        dbranch: ['tc01d','tc02d','tc03d']
    steps:
      - uses: actions/checkout@v2
        with:
          ref: develop
      - name: Reset Compare Branch
        run: |
          git fetch origin ${{ matrix.dbranch }}:${{ matrix.dbranch }}
          git reset --hard ${{ matrix.dbranch }}
      - name: Create Pull Request
        id: cpr
        uses: peter-evans/create-pull-request@v3
        with:
          title: 'Sync tc01d to develop'
          labels: |
            automated pr
            automerge
          token: ${{secrets.GITHUB_TOKEN}}
          branch: develop-tc01d-update
      - name: Approve PR
        uses: hmarr/auto-approve-action@v2
        with:
          github-token: "${{ secrets.DTI_DEVOPS_TOKEN }}"
          pull-request-number:  ${{ steps.cpr.outputs.pull-request-number }}
          
# jobs:
#   sync-main-to-tc01d:
#     runs-on: ubuntu-latest
#     name: Syncing tc01d to develop
#     steps:
#       - name: Checkout
#         uses: actions/checkout@v2
#       - name: Set up Node
#         uses: actions/setup-node@v1
#         with:
#           node-version: 12
#       - name: Opening pull request
#         id: pull
#         uses: tretuna/sync-branches@1.2.0
#         with:
#           GITHUB_TOKEN: ${{secrets.GITHUB_TOKEN}}
#           FROM_BRANCH: "tc01d"
#           TO_BRANCH: "develop"
